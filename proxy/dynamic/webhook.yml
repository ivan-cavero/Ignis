http:
  routers:
    webhook:
      rule: "Host(`webhook.ivancavero.com`)"
      entryPoints:
        - "websecure"
      service: "webhook"
      tls:
        certResolver: "letsencrypt"
      middlewares:
        - "webhook-retry"
        - "webhook-timeout"

  middlewares:
    webhook-retry:
      retry:
        attempts: 3
        initialInterval: "500ms"
    webhook-timeout:
      forwardingTimeouts:
        responseTimeout: 60s

  services:
    webhook:
      loadBalancer:
        servers:
          - url: "http://host.docker.internal:3333"
        passHostHeader: true
        healthCheck:
          path: "/health"
          interval: "10s"
          timeout: "5s"
          port: 3333
